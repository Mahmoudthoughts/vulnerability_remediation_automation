########################################################################################################################
#!!
#! @input username: integration user account
#! @input password: integration user password
#!!#
########################################################################################################################
namespace: io.cloudslang.microfocus.smax.commons
flow:
  name: get_sso_token
  inputs:
    - username: mahmoud
    - password: M@hm0ud@123
    - smax_server: swvm151.hpeswlab.net
    - smax_protocol: https
    - smax_port: '443'
    - tenant_id:
        default: '302842317'
        required: true
  workflow:
    - http_client_post:
        do:
          io.cloudslang.base.http.http_client_post:
            - url: "${smax_protocol+'://'+smax_server+':'+smax_port+'/auth/authentication-endpoint/authenticate/login?TENANTID=302842317'}"
            - auth_type: null
            - trust_all_roots: 'true'
            - headers: null
            - body: "${'{ \"Login\":\"'+username+'\", \"Password\": \"'+password+'\" }'}"
            - content_type: application/json
        publish:
          - return_result
        navigate:
          - SUCCESS: SUCCESS
          - FAILURE: on_failure
  outputs:
    - LWSSO_COOKIE_KEY
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      http_client_post:
        x: 191
        'y': 166
        navigate:
          f3ee1c1b-e34e-f110-a5d7-d379be093c88:
            targetId: 6733bb08-1c96-8c9d-71a6-92eb6ea213cc
            port: SUCCESS
    results:
      SUCCESS:
        6733bb08-1c96-8c9d-71a6-92eb6ea213cc:
          x: 528
          'y': 178
