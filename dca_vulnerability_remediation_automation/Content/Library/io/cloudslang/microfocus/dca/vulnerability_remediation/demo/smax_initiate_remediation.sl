namespace: io.cloudslang.microfocus.dca.vulnerability_remediation.demo
flow:
  name: smax_initiate_remediation
  inputs:
    - ticket_id:
        required: false
    - description:
        required: false
    - remdiation_action:
        required: false
    - remediation_reboot:
        required: false
    - measure_sla:
        required: false
    - remediate_sla:
        required: false
    - requester_name:
        required: false
    - tenant_id:
        required: false
    - attachments:
        required: false
    - entity_type
    - entity_id
  workflow:
    - get_attechment_request:
        do:
          io.cloudslang.microfocus.smax.samples.get_attechment_request:
            - tenant_id: '${tenant_id}'
            - entity_type: '${entity_type}'
            - entity_id: '${entity_id}'
        publish:
          - destination_file
        navigate:
          - FAILURE: on_failure
          - SUCCESS: html_to_text
    - Qualys_vulnerability_report_automation:
        do:
          io.cloudslang.microfocus.dca.vulnerability_remediation.demo.Qualys_vulnerability_report_automation:
            - remediation_request_id: '${entity_id}'
            - requester_name: '${requester_name}'
            - request_description: '${description}'
            - measure_sla: '${measure_sla}'
            - remediate_sla: '${remediate_sla}'
            - remdiation_action: '${remdiation_action.replace("_c","")}'
            - remediation_reboot: '${remediation_reboot.replace("_c","")}'
            - excelFileName: '${destination_file}'
            - filename: '${destination_file}'
        navigate:
          - FAILURE: on_failure
          - SUCCESS: SUCCESS
    - html_to_text:
        do:
          io.cloudslang.base.html.html_to_text:
            - html: '${description}'
        publish:
          - description: '${text}'
        navigate:
          - SUCCESS: Qualys_vulnerability_report_automation
  outputs:
    - report
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_attechment_request:
        x: 100
        'y': 150
      html_to_text:
        x: 400
        'y': 150
      Qualys_vulnerability_report_automation:
        x: 700
        'y': 150
        navigate:
          f3efaa85-6195-299d-872f-a182c04a07f8:
            targetId: 5acb54ef-2e47-daf4-cf50-716ae4a5694a
            port: SUCCESS
    results:
      SUCCESS:
        5acb54ef-2e47-daf4-cf50-716ae4a5694a:
          x: 1000
          'y': 150
