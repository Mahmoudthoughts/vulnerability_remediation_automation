namespace: io.cloudslang.microfocus.dca.vulnerability_remediation
flow:
  name: policy_scan_for_resource_group
  inputs:
    - policy_id:
        default: RR21334345566_policy
        required: false
    - auth_token:
        required: false
    - resource_group_name:
        default: '77'
        required: false
    - basic_json: |-
        {
            "jobType": {
                "name": "POLICY_SCAN"
            },
            "targets": [],
            "properties": [],
            "targetsQuery": "",
            "schedule": {
                "type": "NOW"
            }
        }
  workflow:
    - policy_scan:
        do:
          io.cloudslang.microfocus.dca.scheduler.policy_scan:
            - policy_id: '16'
            - resource_group_name: RR21334345566_resource_group
        publish:
          - full_json
        navigate:
          - FAILURE: on_failure
          - SUCCESS: job_creator
    - job_creator:
        do:
          io.cloudslang.microfocus.dca.scheduler.job_creator:
            - auth_token: '${auth_token}'
            - full_json: '${full_json}'
        navigate:
          - FAILURE: on_failure
          - SUCCESS: SUCCESS
  results:
    - SUCCESS
    - FAILURE
extensions:
  graph:
    steps:
      policy_scan:
        x: 100
        'y': 150
      job_creator:
        x: 400
        'y': 150
        navigate:
          c9de7e5a-411c-0184-5213-2be9a14dc5a0:
            targetId: 1ddb1942-f454-7a52-0692-58459c0ff813
            port: SUCCESS
    results:
      SUCCESS:
        1ddb1942-f454-7a52-0692-58459c0ff813:
          x: 700
          'y': 150
