namespace: io.cloudslang.microfocus.dca.vulnerability_remediation
flow:
  name: policy_scan_for_resource_group
  inputs:
    - policy_id:
        default: RR21334345566_policy
        required: false
    - auth_token:
        required: false
    - resource_group_name:
        default: '77'
        required: false
    - basic_json: |-
        {
            "jobType": {
                "name": "POLICY_SCAN"
            },
            "targets": [],
            "properties": [],
            "targetsQuery": "",
            "schedule": {
                "type": "NOW"
            }
        }
  workflow:
    - get_authentication_token_1:
        do:
          io.cloudslang.microfocus.dca.authentication.get_authentication_token:
            - idm_host: swdemo10.hpeswlab.net
            - idm_username: transport_admin
            - idm_password:
                value: WhTySQ4TDj
                sensitive: true
            - dca_username: dcaadmin
            - dca_password:
                value: Automation.123
                sensitive: true
            - trust_all_roots: 'true'
        publish:
          - auth_token
        navigate:
          - SUCCESS: policy_scan
          - FAILURE: on_failure
    - policy_scan:
        do:
          io.cloudslang.microfocus.dca.scheduler.policy_scan:
            - policy_id: '16'
            - resource_group_name: RR21334345566_resource_group
        publish:
          - full_json
        navigate:
          - FAILURE: on_failure
          - SUCCESS: job_creator
    - job_creator:
        do:
          io.cloudslang.microfocus.dca.scheduler.job_creator:
            - auth_token: '${auth_token}'
            - full_json: '${full_json}'
        navigate:
          - FAILURE: on_failure
          - SUCCESS: SUCCESS
  results:
    - SUCCESS
    - FAILURE
extensions:
  graph:
    steps:
      get_authentication_token_1:
        x: 100
        'y': 150
      policy_scan:
        x: 400
        'y': 150
      job_creator:
        x: 700
        'y': 150
        navigate:
          391a242f-a0b7-84dd-940a-e55a100c2adf:
            targetId: 7a8fa778-8e08-2f8c-3f7c-b9a467f994de
            port: SUCCESS
    results:
      SUCCESS:
        7a8fa778-8e08-2f8c-3f7c-b9a467f994de:
          x: 1000
          'y': 150
