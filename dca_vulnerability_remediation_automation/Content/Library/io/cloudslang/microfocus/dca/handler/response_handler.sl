namespace: io.cloudslang.microfocus.dca.handler
flow:
  name: response_handler
  inputs:
    - response: '{"errorCode":"CreatePolicyError","message":"Unable to create the policy","details":"Entity PolicyPlan with name RR213343_policy already exists","arguments":[]}'
  workflow:
    - get_value:
        do:
          io.cloudslang.base.json.get_value:
            - json_input: '${response}'
            - json_path: details
        publish:
          - details: '${return_result}'
        navigate:
          - SUCCESS: already_exists
          - FAILURE: on_failure
    - already_exists:
        do:
          io.cloudslang.base.strings.string_occurrence_counter:
            - string_in_which_to_search: '${details}'
            - string_to_find: already exists
        navigate:
          - SUCCESS: SUCCESS
          - FAILURE: on_failure
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_value:
        x: 232
        'y': 313
      already_exists:
        x: 381
        'y': 253
        navigate:
          3a9704fd-2226-fe9b-4b05-024a2a8ba2f3:
            targetId: e2c3e037-7247-96d2-9c8f-c5dfd44a52fa
            port: SUCCESS
    results:
      SUCCESS:
        e2c3e037-7247-96d2-9c8f-c5dfd44a52fa:
          x: 625
          'y': 334
