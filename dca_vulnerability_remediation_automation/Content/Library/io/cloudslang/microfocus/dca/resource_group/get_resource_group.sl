namespace: io.cloudslang.microfocus.dca.resource_group
flow:
  name: get_resource_group
  inputs:
    - resource_group_name:
        required: false
    - auth_token:
        required: false
    - dca_server:
        default: "${get_sp('dca.host')}"
        required: false
    - dca_port:
        default: "${get_sp('dca.port')}"
        required: false
    - dca_protocol:
        default: "${get_sp('dca.protocol')}"
        required: false
  workflow:
    - http_client_get:
        do:
          io.cloudslang.base.http.http_client_get:
            - url: "${dca_protocol+'://'+dca_server+':'+dca_port+\"/urest/v1/resource_group\"}"
            - trust_all_roots: 'true'
            - headers: "${'X-Auth-Token:' + auth_token}"
            - query_params: "${\"count=1&query=name LIKE '\"+resource_group_name+\"%'\"}"
            - content_type: application/json
        publish:
          - return_result
        navigate:
          - SUCCESS: get_item_id
          - FAILURE: on_failure
    - get_item_id:
        do:
          io.cloudslang.base.json.get_value:
            - json_input: '${return_result}'
            - json_path: 'members,0,uuid'
        publish:
          - item_id: '${return_result}'
        navigate:
          - SUCCESS: SUCCESS
          - FAILURE: on_failure
  outputs:
    - resource_group_id: '${item_id}'
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      http_client_get:
        x: 208
        'y': 148
      get_item_id:
        x: 420
        'y': 170
        navigate:
          6f226bc8-642f-4e06-e5fc-06c307aba1c3:
            targetId: 0baa85f9-1ba3-1ef3-ca7d-07692630149e
            port: SUCCESS
    results:
      SUCCESS:
        0baa85f9-1ba3-1ef3-ca7d-07692630149e:
          x: 700
          'y': 150
