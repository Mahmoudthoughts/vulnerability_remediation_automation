namespace: draft
flow:
  name: test_flow_inputs
  inputs:
    - flow_input_1:
        required: false
    - excelFileName:
        required: false
    - worksheetName:
        required: false
    - columnIndex:
        required: false
    - dca_server:
        required: false
    - dca_port:
        required: false
    - remediation_requet:
        required: false
  workflow:
    - get_valid_rows:
        do_external:
          5a1ae0e4-102e-4981-8c76-94b8ae6944ec:
            - firstRowIndex: '0'
        publish:
          - rows: '${valid_rows}'
        navigate:
          - failure: on_failure
          - success: list_iterator
    - get_values:
        do_external:
          2ec5f196-4c98-4100-a2af-fb22dae4c9ed:
            - excelFileName: "C:\\qualys\\sample.xlsx"
            - worksheetName: sample
            - hasHeader: 'yes'
            - rowIndex: '${rowIndex}'
        publish:
          - details: '${values}'
        navigate:
          - success: server_name
          - failure: on_failure
    - list_iterator:
        do:
          io.cloudslang.base.lists.list_iterator:
            - list: '${rows}'
        publish:
          - rowIndex: '${result_string}'
        navigate:
          - HAS_MORE: get_values
          - NO_MORE: SUCCESS
          - FAILURE: on_failure
    - server_name:
        do:
          io.cloudslang.base.lists.get_by_index:
            - list: '${details}'
            - delimiter: '|'
            - index: '1'
        publish:
          - server_name: '${return_result}'
        navigate:
          - SUCCESS: CVEs
          - FAILURE: on_failure
    - CVEs:
        do:
          io.cloudslang.base.lists.get_by_index:
            - list: '${details}'
            - delimiter: '|'
            - index: '0'
        publish:
          - cve_list: '${return_result}'
        navigate:
          - SUCCESS: kb_article
          - FAILURE: on_failure
    - kb_article:
        do:
          io.cloudslang.base.lists.get_by_index:
            - list: '${details}'
            - delimiter: '|'
            - index: '2'
        publish:
          - kb_articles: '${return_result}'
        navigate:
          - SUCCESS: list_iterator
          - FAILURE: on_failure
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_valid_rows:
        x: 100
        'y': 250
      list_iterator:
        x: 400
        'y': 250
        navigate:
          eb2c3871-9671-7291-19b7-3a7b00071eb1:
            targetId: b9f39065-3739-5174-07bc-e9199fae13da
            port: NO_MORE
      get_values:
        x: 700
        'y': 125
      server_name:
        x: 1000
        'y': 250
      CVEs:
        x: 1300
        'y': 250
      kb_article:
        x: 1600
        'y': 250
        navigate:
          2f1ec047-4fd1-4582-e503-cceaf83d2592:
            vertices:
              - x: 895
                'y': 636
            targetId: list_iterator
            port: SUCCESS
    results:
      SUCCESS:
        b9f39065-3739-5174-07bc-e9199fae13da:
          x: 700
          'y': 375
