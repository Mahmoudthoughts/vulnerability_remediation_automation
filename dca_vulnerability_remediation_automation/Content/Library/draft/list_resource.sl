namespace: draft
flow:
  name: list_resource
  inputs:
    - dca_server: "${get_sp('dca.host')}"
    - dca_port: "${get_sp('dca.port')}"
    - dca_protocol: "${get_sp('dca.protocol')}"
  workflow:
    - get_authentication_token:
        do:
          io.cloudslang.microfocus.dca.authentication.get_authentication_token:
            - idm_host: swdemo10.hpeswlab.net
            - idm_username: transport_admin
            - idm_password:
                value: WhTySQ4TDj
                sensitive: true
            - dca_username: dcaadmin
            - dca_password:
                value: Automation.123
                sensitive: true
            - trust_all_roots: 'true'
        publish:
          - output_0: '${return_code}'
          - output_1: '${return_result}'
          - auth_token
        navigate:
          - SUCCESS: get_resource_id
          - FAILURE: on_failure
    - get_resource_id:
        do:
          io.cloudslang.microfocus.dca.resource.get_resource_id:
            - name: som2.hpeswlab.net
            - auth_token: '${auth_token}'
        publish:
          - resource_id
        navigate:
          - FAILURE: on_failure
          - SUCCESS: add_resource_to_resource_group
    - add_resource_to_resource_group:
        do:
          io.cloudslang.microfocus.dca.resource.add_resource_to_resource_group:
            - auth_token: '${auth_token}'
            - resource_id: '${resource_id}'
            - resource_group_id: 4586c49e5effdbd9849fe3ae8943ff07
        publish:
          - return_results
        navigate:
          - FAILURE: on_failure
          - SUCCESS: SUCCESS
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_authentication_token:
        x: 100
        'y': 150
      get_resource_id:
        x: 400
        'y': 150
      add_resource_to_resource_group:
        x: 700
        'y': 150
        navigate:
          f3dc6fa6-ff29-47a3-c16f-2fb2881a8ba6:
            targetId: cc8212c9-9043-dd5c-ea07-3de1d8ccc911
            port: SUCCESS
    results:
      SUCCESS:
        cc8212c9-9043-dd5c-ea07-3de1d8ccc911:
          x: 898
          'y': 149
