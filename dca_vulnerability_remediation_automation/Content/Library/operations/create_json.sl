namespace: operations
flow:
  name: create_json
  inputs:
    - keys: 'name,age,location'
    - values: 'mahmoud,thirty,Dubai'
    - separator: ','
    - json: '{}'
    - created_json:
        required: false
  workflow:
    - list_keys:
        do:
          io.cloudslang.base.lists.list_iterator:
            - list: '${keys}'
        publish:
          - key: '${result_string}'
        navigate:
          - HAS_MORE: default_if_empty
          - NO_MORE: SUCCESS
          - FAILURE: on_failure
    - list_value:
        do:
          io.cloudslang.base.lists.list_iterator:
            - list: '${values}'
        publish:
          - value: '${result_string}'
        navigate:
          - HAS_MORE: add_value
          - NO_MORE: list_keys
          - FAILURE: on_failure
    - add_value:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${created_json}'
            - json_path: '${key}'
            - value: '${value}'
        publish:
          - created_json: '${return_result}'
        navigate:
          - SUCCESS: list_keys
          - FAILURE: on_failure
    - default_if_empty:
        do:
          io.cloudslang.base.utils.default_if_empty:
            - initial_value: '${created_json}'
            - created_json: null
        publish:
          - created_json: '${return_result}'
        navigate:
          - SUCCESS: add_value_1
          - FAILURE: on_failure
    - add_value_1:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${created_json}'
            - json_path: '${key}'
            - value: ' '
        publish:
          - created_json: '${return_result}'
        navigate:
          - SUCCESS: list_value
          - FAILURE: on_failure
  outputs:
    - json_output: '${created_json}'
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      list_keys:
        x: 100
        'y': 150
        navigate:
          6127ff6b-6bc6-6836-e7a3-ae629f90bda8:
            targetId: 97fa31b3-e9ad-34ce-39ea-4e0b5593104a
            port: NO_MORE
      list_value:
        x: 552
        'y': 171
        navigate:
          74e706ba-cb65-dfb4-88eb-d9fd90d991a8:
            vertices:
              - x: 320
                'y': 126
            targetId: list_keys
            port: NO_MORE
      add_value:
        x: 700
        'y': 150
        navigate:
          6bce1624-0912-960c-07c6-315da361c8ff:
            vertices:
              - x: 457
                'y': 48
            targetId: list_keys
            port: SUCCESS
      default_if_empty:
        x: 272
        'y': 157
      add_value_1:
        x: 382
        'y': 167
    results:
      SUCCESS:
        97fa31b3-e9ad-34ce-39ea-4e0b5593104a:
          x: 405
          'y': 329
