namespace: io.cloudslang.microfocus.oo.flow
flow:
  name: flow_execution_json
  inputs:
    - flowUuid:
        required: false
    - runName:
        required: false
    - logLevel:
        required: false
    - inputs:
        required: false
    - basic_json:
        required: false
  workflow:
    - default_if_empty:
        do:
          io.cloudslang.base.utils.default_if_empty:
            - initial_value: '${basic_json}'
            - default_value: '{}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: list_iterator
          - FAILURE: on_failure
    - get_key_value:
        do:
          io.cloudslang.microfocus.oo.flow.get_key_value:
            - text: '${input}'
            - separator: ':'
        publish:
          - key
          - value
        navigate:
          - SUCCESS: add_value
    - list_iterator:
        do:
          io.cloudslang.base.lists.list_iterator:
            - list: '${inputs}'
            - separator: '|'
        publish:
          - input: '${result_string}'
        navigate:
          - HAS_MORE: get_key_value
          - NO_MORE: add_json_property_to_object
          - FAILURE: on_failure
    - add_value:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${flow_input_json}'
            - json_path: '${key}'
            - value: '${value}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: list_iterator
          - FAILURE: on_failure
    - add_json_property_to_object:
        do:
          io.cloudslang.base.json.add_json_property_to_object:
            - json_object: '{"inputs":""}'
            - key: inputs
            - value: '${flow_input_json}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: add_flowUuid
          - FAILURE: on_failure
    - add_flowUuid:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${flow_input_json}'
            - json_path: uuid
            - value: '${flowUuid}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: is_null
          - FAILURE: on_failure
    - add_runName:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${flow_input_json}'
            - json_path: runName
            - value: '${runName}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: add_logLevel
          - FAILURE: on_failure
    - add_logLevel:
        do:
          io.cloudslang.base.json.add_value:
            - json_input: '${flow_input_json}'
            - json_path: logLevel
            - value: '${logLevel}'
        publish:
          - flow_input_json: '${return_result}'
        navigate:
          - SUCCESS: SUCCESS
          - FAILURE: on_failure
    - is_null:
        do:
          io.cloudslang.base.utils.is_null:
            - variable: '${runName}'
        navigate:
          - IS_NULL: is_null_1
          - IS_NOT_NULL: add_runName
    - is_null_1:
        do:
          io.cloudslang.base.utils.is_null:
            - variable: '${logLevel}'
        navigate:
          - IS_NULL: SUCCESS
          - IS_NOT_NULL: add_logLevel
  outputs:
    - flow_input_json: '${flow_input_json}'
  results:
    - SUCCESS
    - FAILURE
extensions:
  graph:
    steps:
      add_flowUuid:
        x: 1000
        'y': 376
      get_key_value:
        x: 700
        'y': 125
      default_if_empty:
        x: 100
        'y': 250
      is_null_1:
        x: 1600
        'y': 125
        navigate:
          8e41311b-1fe5-07aa-3053-713ef674bf6b:
            targetId: 7c24e501-3486-b379-2d82-ff30eddcbe41
            port: IS_NULL
      list_iterator:
        x: 400
        'y': 250
      add_json_property_to_object:
        x: 700
        'y': 374
      add_value:
        x: 1000
        'y': 125
      add_runName:
        x: 1600
        'y': 375
      is_null:
        x: 1300
        'y': 250
      add_logLevel:
        x: 1901
        'y': 250
        navigate:
          24c4e318-4ef5-c252-a18d-4de74d29e4af:
            targetId: 7c24e501-3486-b379-2d82-ff30eddcbe41
            port: SUCCESS
    results:
      SUCCESS:
        7c24e501-3486-b379-2d82-ff30eddcbe41:
          x: 2200
          'y': 250
